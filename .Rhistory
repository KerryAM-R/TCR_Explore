tabPanel("Overview of Pairing",
uiOutput("video2"),
),
tabPanel("Motif analysis",
uiOutput("video3"),
),
tabPanel("Diversity and chain usage",
uiOutput("video4"),
),
tabPanel("Overlap",
uiOutput("video5"),
),
tabPanel("Paired TCR with Index data",
uiOutput("video6"),
),
),
),
tabPanel("Session info",
tabPanel("Session info",
div(style="width:800px",
verbatimTextOutput("sessionInfo")),
tags$head(includeHTML(("google-analytics.html")))
)
)
)
library(shiny); runApp('TCR_Explore_v1.0.R')
library(shiny); runApp('TCR_Explore_v1.0.R')
library(shiny); runApp('TCR_Explore_v1.0.R')
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
head(x)
head(x$frame_type)
uniqu(x$frame_type)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
unique(x2$frame_type)
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(j_gene,v_gene)
names(x2)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(j_gene)
drop_na(j_gene)
x2 <- x2 %>% drop_na(x2$j_gene)
x2 <- x2 %>% drop_na(x2$j_gene,x2$v_gene)
x2 %>% drop_na(x2$j_gene,x2$v_gene)
View(x2)
x2[!is.na(x2$x2),]
x2[!is.na(x2$v_gene),]
x2 <- x2[!is.na(x2$v_gene),]
x2 <- x2[!is.na(v_gene),]
x2 <- x2[!is.na(x2$v_gene),]
x2 <- x2[!is.na(x2$j_gene),]
is.na(x2$j_gene)
unique(is.na(x2$j_gene))
unique(x2$j_gene)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- subset(x2, x2$frame_type=="In")
unique(x2$j_gene)
x2 <- x2[!is.na(x2$v_gene),]
View(x2)
x2 <- x2 %>% mutate_all(na_if,"")
x2 %>% drop_na(x2$v_gene)
x2 %>% drop_na(v_gene)
dim(x2 %>% drop_na(v_gene))
x2 <- x2 %>% drop_na(v_gene,j_gene)
x <- x %>% mutate_all(na_if,"")
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- x %>%
select_if(~ !any(is.na(.)))
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
dataframe = read.table("test-data/sampleExport/TCRG_MRD_Day29_Case1.tsv",sep="\t",header=T)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(v_gene,j_gene)
x2 <- data.frame(cloneCount = x2$seq_reads, x2)
x2 <- data.frame(cloneCount = x2$sequence_result_status, x2)
summary(x2$sequence_result_status)
View(x2)
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(v_gene,j_gene)
summary(x2$sequence_result_status)
x2 <- data.frame(cloneCount = x2$templates, x2)
x3 <- x2[!names(x2) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive","seq_reads",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3$TRJ <- gsub("^TCR","",x3$j_family)
x3$TRV <- gsub("^TCR","",x3$v_family)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3
require(tidyverse)
dataframe = read.table("test-data/sampleExport/TCRG_MRD_Day29_Case1.tsv",sep="\t",header=T)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(v_gene,j_gene)
summary(x2$sequence_result_status)
x2 <- data.frame(cloneCount = x2$templates, x2)
x3 <- x2[!names(x2) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive","seq_reads",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3$TRJ <- gsub("^TCR","",x3$j_family)
x3$TRV <- gsub("^TCR","",x3$v_family)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3
runApp('TCR_Explore_v1.0.R')
runApp('TCR_Explore_v1.0.R')
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x2 %>% mutate_all(na_if,"")
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- x2 %>% drop_na(v_gene,j_gene)
summary(x2$sequence_result_status)
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x2 <- data.frame(cloneCount = x2$templates, x2)
names(x2)
summary(x2$cloneCount)
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
summary(x2$cloneCount)
runApp('TCR_Explore_v1.0.R')
runApp('TCR_Explore_v1.0.R')
runApp('TCR_Explore_v1.0.R')
runApp('TCR_Explore_v1.0.R')
library(shiny); runApp('TCR_Explore_v1.0.R')
require(tidyverse)
dataframe = read.table("test-data/sampleExport/TCRG_MRD_Day29_Case1.tsv",sep="\t",header=T)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3 <- x3[!is.na(x3[names(x3) %in% c("cloneCount")]),]
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
summary(x2$cloneCount)
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
gsub(NA,"-",x3)
gsub(NA,"-",x3$d_gene)
gsub("NA","-",x3$d_gene)
x3[is.na(x3)] <- "-"
x3
require(tidyverse)
dataframe = read.table("test-data/sampleExport/TCRG_MRD_Day29_Case1.tsv",sep="\t",header=T)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3 <- x3[!is.na(x3[names(x3) %in% c("cloneCount")]),]
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
summary(x2$cloneCount)
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3)] <- "-"
View(x3)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3 <- x3[!is.na(x3[names(x3) %in% c("cloneCount")]),]
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
summary(x2$cloneCount)
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3)]
x3 <- x2
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
summary(x2$cloneCount)
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3)]
x3[is.na(x3$)]
x3[is.na(x3$TRJ)]
x3[is.na(x3$TRJ),]
x3[is.na(x3$TRD),]
x3[is.na(x3$TRV),]
x3[is.na(x3$TRD),]
x3[is.na(x3)]
View(x3)
runApp('TCR_Explore_v1.0.R')
runApp('TCR_Explore_v1.0.R')
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3$TRD)]
x3[,is.na(x3$TRD)]
x3[is.na(x3$TRD),]
x3[is.na(x3$TRD)] <- "-"
x3[is.na(x3$TRD)] <- 0
x3[is.na(x3)] <- 0
x3
x3[is.na(x3)] <- "Missing data"
x3[is.na(x3$TRD),]
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3$TRD),]
x3[is.na(x3)] <- "Missing data"
x3
x3[is.na(x3)] <- "-"
require(tidyverse)
dataframe = read.table("test-data/sampleExport/TCRG_MRD_Day29_Case1.tsv",sep="\t",header=T)
x <- read.table("test-data/QC/ImmunoSEQ/ES8_TSNLQEQIGW_3.tsv",sep="\t",header=T)
unique(x$frame_type)
x2 <- x %>%
select_if(~ !any(is.na(.)))
x2 <- x2 %>% mutate_all(na_if,"")
x2 <- subset(x2, x2$frame_type=="In")
x2 <- data.frame(cloneCount = x2[names(x2) %in% "templates"], x2)
x3 <- x2
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads",
"fraction_productive",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads"
)]
x3[is.na(x3$TRD),]
x3[is.na(x3)] <- "-"
x3
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads","sample_catalog_tags","sample_rich_tags_json",
"fraction_productive","sample_tags","sku","total_templates",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads","sample_cell",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties","antibody",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads",
"v_deletions",	"d5_deletions",	"d3_deletions",	"j_deletions",	"n2_insertions",
"n1_insertions",	"v_index",	"n1_index",	"n2_index",	"d_index",	"j_index",	"v_family_ties",	"d_family_ties",	"d_gene_ties",	"d_allele_ties",	"j_gene_ties"
)]
x3[is.na(x3$TRD),]
x3[is.na(x3)] <- "-"
x3
View(x3)
runApp('TCR_Explore_v1.0.R')
x3 <- gsub(" ","",x3)
unique(x3$TRJ)
x3 <- gsub(" ","",x3$TRJ)
x3 <- x2
x3$TRJ <- x3[names(x3) %in% "j_family"]
x3$TRJ
gsub("^TCR","",x3$j_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads","sample_catalog_tags","sample_rich_tags_json",
"fraction_productive","sample_tags","sku","total_templates",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads","sample_cell",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties","antibody",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads",
"v_deletions",	"d5_deletions",	"d3_deletions",	"j_deletions",	"n2_insertions",
"n1_insertions",	"v_index",	"n1_index",	"n2_index",	"d_index",	"j_index",	"v_family_ties",	"d_family_ties",	"d_gene_ties",	"d_allele_ties",	"j_gene_ties"
)]
x3[is.na(x3$TRD),]
x3[is.na(x3)] <- "-"
x3$TRJ <- gsub(" ","",x3$TRJ)
unique(x3$TRJ)
x3$v_gene <- gsub(" ","",x3$v_gene)
x3$TRV <- gsub("^TCR","",x3$v_gene)
x3$TRJ <- gsub("^TCR","",x3$j_gene)
x3$TRD <- gsub("^TCR","",x3$d_gene)
x3 <- x3[!is.na(x3[names(x3) %in% c("TRV")]),]
x3$TRVJ <- paste(x3$TRV,x3$TRJ,sep=".")
x3$TRVDJ <- paste(x3$TRV,x3$TRD,x3$TRJ,sep=".")
x3$TRVDJ <- gsub(".NA.",".",x3$TRVDJ)
x3$TRVJ_CDR3 <- paste(x3$TRVJ,x3$amino_acid,sep="_")
x3 <- x3[!names(x3) %in% c("product_subtype","frame_type","total_dj_reads",
"productive_entropy","rearrangement_type",
"order_name","release_date",
"upload_date","primer_set",
"total_outofframe_reads","sample_catalog_tags","sample_rich_tags_json",
"fraction_productive","sample_tags","sku","total_templates",
"sequence_result_status","productive_clonality","stop_rearrangements",
"outofframe_rearrangements","total_rearrangements","total_reads","sample_cell",
"productive_rearrangements","counting_method","v_allele_ties","v_gene_ties","antibody",
"sample_clonality", "max_productive_frequency","sample_entropy","sample_simpson_clonality",
"max_frequency","productive_simpson_clonality","total_stop_reads","total_productive_reads",
"v_deletions",	"d5_deletions",	"d3_deletions",	"j_deletions",	"n2_insertions",
"n1_insertions",	"v_index",	"n1_index",	"n2_index",	"d_index",	"j_index",	"v_family_ties",	"d_family_ties",	"d_gene_ties",	"d_allele_ties",	"j_gene_ties"
)]
x3[is.na(x3$TRD),]
x3[is.na(x3)] <- "-"
unique(x3$v_gene)
unique(x3$j_gene)
unique(x3$j_family)
runApp('TCR_Explore_v1.0.R')
